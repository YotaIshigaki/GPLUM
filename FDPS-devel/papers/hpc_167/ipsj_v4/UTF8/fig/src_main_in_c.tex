%\documentclass[10pt,twocolumn,a4paper,fleqn]{article}
\documentclass[10pt,a4paper,fleqn]{article}


%%%%% AUTHORS - PLACE YOUR OWN PACKAGES HERE %%%%%
\usepackage[x11names,table]{xcolor}
\usepackage{moresize}
\usepackage{minted}
\usepackage{mdframed}
\usepackage{caption}

%%% minted setting %%%
%\setminted{fontsize=\tiny,baselinestretch=1}
%\setminted{fontsize=\fontsize{5.21}{6}\selectfont,baselinestretch=1}
%\setminted{fontsize=\scriptsize,baselinestretch=1}
%\setminted{fontsize=\footnotesize,baselinestretch=1}
\setminted{fontsize=\fontsize{9}{1em}\selectfont,baselinestretch=1}
%\setminted{fontsize=\small,baselinestretch=1}

%%% Page size setting %%%
\topmargin=0mm
\oddsidemargin=-5mm
\evensidemargin=-5mm
\textheight=222mm
\textwidth=165mm


% Beginning of document
\begin{document}
\pagenumbering{gobble}

\definecolor{bg}{rgb}{0.95,0.95,0.95}
\begin{mdframed}[
    backgroundcolor=bg,
    topline=false,
    bottomline=false,
    leftline=false,
    rightline=false]
\begin{minted}[fontfamily=courier,linenos=true, breaklines]{c}
int c_main()
{
    // FDPSの初期化
    fdps_initialize();
    // DomainInfoオブジェクトの生成と初期化
    int dinfo_num;
    float coef_ema=0.3;
    fdps_create_dinfo(&dinfo_num);
    fdps_init_dinfo(dinfo_num,coef_ema);
    // ParticleSystemオブジェクトの生成と初期化
    int psys_num;
    fdps_create_psys(&psys_num,"full_particle");
    fdps_init_psys(psys_num);
    // TreeForForceオブジェクトの生成と初期化
    int tree_num;
    fdps_create_tree(&tree_num, 
                     "Long,full_particle,full_particle,full_particle,Monopole");
    int ntot=1024;
    double theta = 0.5;
    int n_leaf_limit = 8;
    int n_group_limit = 64;
    fdps_init_tree(tree_num, ntot, theta, n_leaf_limit, n_group_limit);
    
    // 初期条件作成 (省略)

    // 領域分割と粒子交換
    fdps_decompose_domain_all(dinfo_num,psys_num,-1.0);
    fdps_exchange_particle(psys_num,dinfo_num);
    // 相互作用計算
    fdps_calc_force_all_and_write_back(tree_num, 
                                       calc_gravity_ep_ep,
                                       calc_gravity_ep_sp,
                                       psys_num,
                                       dinfo_num,
                                       true,
                                       FDPS_MAKE_LIST);
    // 粒子の軌道の時間積分
    double time_sys  = 0;
    double time_end = 10.0;
    double dt = 1.0/128.0;
    while (time_sys <= time_end){
        kick(psys_num,0.5*dt);
        time_sys +=  dt;
        drift(psys_num,dt);
        // 領域分割と粒子交換
        fdps_decompose_domain_all(dinfo_num,psys_num,-1.0);
        fdps_exchange_particle(psys_num,dinfo_num);
        // 相互作用計算
        fdps_calc_force_all_and_write_back(tree_num,
                                           calc_gravity_ep_ep,
                                           calc_gravity_ep_sp,
                                           psys_num,
                                           dinfo_num,
                                           true,
                                           FDPS_MAKE_LIST);
        kick(psys_num,0.5*dt);
    }
    fdps_finalize();
    return 0;
}
\end{minted}
\end{mdframed}



% End of Document
\end{document}
