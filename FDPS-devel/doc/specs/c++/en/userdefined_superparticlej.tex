\subsubsection{Summary}The class \texttt{SuperParticleJ} encapsulates the informations of a grouped particles (see, step 0 in Sec. \ref{sec:overview_action}). This class is required if one of the followings are employed as \texttt{PS::SEARCH\_MODE}.
\begin{itemize}[itemsep=-1ex]
\item \texttt{PS::SEARCH\_MODE\_LONG}
\item \texttt{PS::SEARCH\_MODE\_LONG\_SCATTER}
\item \texttt{PS::SEARCH\_MODE\_LONG\_SYMMETRY}
\item \texttt{PS::SEARCH\_MODE\_LONG\_CUTOFF}  
\end{itemize}This class has a member function which is used for data-transfer between FDPS. This class is related to \texttt{Moment} class. Thus, this class has member functions which cast the \texttt{Moment} class to this class (and vice versa).Similar to \texttt{Moment} class, since this class has prescribed rules, FDPS has pre-defined classes.This section aims to describe the specific member functions both always and in specific case required for \texttt{SuperParticleJ}.\subsubsection{Pre-defined class}FDPS \texttt{has} some pre-defined \texttt{SuperParticleJ} class. Below, the available classes for each \texttt{PS::SEARCH\_MODE} are described.\subsubsubsection{PS::SEARCH\_MODE\_LONG}\subsubsubsubsection{PS::SPJMonopole}
\label{sec:SPJMonopole}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentMonopole} class. It contains up to monopole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJMonopole {    public:        F64    mass;        F64vec pos;    };}\end{verbatim}\end{screen}\begin{itemize}\item Name of the class
  \texttt{PS::SPJMonopole}\item Members and their information  \texttt{mass}: accumulated mass or electron charge.  \texttt{pos}: center of mass or center of charge.\item Terms of use  The same as \texttt{PS::MomentMonopole} class.\end{itemize}\subsubsubsubsection{PS::SPJQuadrupole}
\label{sec:SPJQuadrupole}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentQuadrupole} class. It contains up to quadrupole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJQuadrupole {    public:        F64    mass;        F64vec pos;        F64mat quad;    };}\end{verbatim}\end{screen}\begin{itemize}\item Name of the class

  \texttt{PS::SPJQuadrupole}\item Members and their information  \texttt{mass}: accumulated mass.  \texttt{pos}: center of mass.  \texttt{quad}: accumulated quadrupole.\item Terms of use  The same as \texttt{PS::MomentQuadrupole} class.\end{itemize}\subsubsubsubsection{PS::SPJMonopoleGeometricCenter}
\label{sec:SPJMonopoleGeometricCenter}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentMonopoleGeometricCenter} class. It contains up to quadrupole moment (the reference point is set to geometric center of grouped particles).\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJMonopoleGeometricCenter {    public:        F64    charge;            F64vec pos;    };}\end{verbatim}\end{screen}\begin{itemize}\item Name of the class
  \texttt{PS::SPJMonopoleGeometricCenter}\item Members and their information  \texttt{charge}: accumulated mass/charge.  \texttt{pos}: geometric center.\item Terms of use  The same as \texttt{PS::MomentMonopoleGeometricCenter} class.\end{itemize}\subsubsubsubsection{PS::SPJDipoleGeometricCenter}
\label{sec:SPJDipoleGeometricCenter}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentDipoleGeometricCenter} class. It contains up to dipole moment (the reference point is set to geometric center of grouped particles).\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJDipoleGeometricCenter {    public:        F64    charge;            F64vec pos;        F64vec dipole;    };}\end{verbatim}\end{screen}\begin{itemize}
\item Name of the class
  \texttt{PS::SPJDipoleGeometricCenter}\item Members and their information  \texttt{charge}: accumulated mass/charge.  \texttt{pos}: geometric center.  \texttt{dipole}: dipole of the particle mass or electron charge.\item Terms of use  The same as \texttt{PS::MomentDipoleGeometricCenter} class.\end{itemize}\subsubsubsubsection{PS::SPJQuadrupoleGeometricCenter}
\label{sec:SPJQuadrupoleGeometricCenter}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentQuadrupoleGeometricCenter} class. It contains up to quadrupole moment (the reference point is set to geometric center of grouped particles).\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJQuadrupoleGeometricCenter {    public:        F64    charge;        F64vec pos;        F64vec dipole;        F64mat quadrupole;    };}\end{verbatim}\end{screen}\begin{itemize}
\item Name of the class
  \texttt{PS::SPJQuadrupoleGeometricCenter}\item Members and their information  \texttt{charge}: accumulated mass/charge.  \texttt{pos}: geometric center.  \texttt{dipole}: dipole of the particle mass or electron charge.  \texttt{quadrupole}: quadrupole of the particle mass or electron charge.\item Terms of use  The same as \texttt{PS::MomentQuadrupoleGeometricCenter} class.\end{itemize}

\subsubsubsection{PS::SEARCH\_MODE\_LONG\_SCATTER}\subsubsubsubsection{PS::SPJMonopoleScatter}
\label{sec:SPJMonopoleScatter}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentMonopoleScatter} class. It contains up to monopole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJMonopoleScatter {    public:        F64    mass;        F64vec pos;    };}\end{verbatim}\end{screen}\begin{itemize}
  
\item Name of the class
  \texttt{PS::SPJMonopoleScatter}\item Members and their information  \texttt{mass}: accumulated mass or electron charge.  \texttt{pos}: center of mass or center of charge.\item Terms of use  The same as \texttt{PS::MomentMonopoleScatter} class.\end{itemize}  

\subsubsubsubsection{PS::SPJQuadrupoleScatter}
\label{sec:SPJQuadrupoleScatter}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentQuadrupoleScatter} class. It contains up to quadrupole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJQuadrupoleScatter {    public:        F64    mass;        F64vec pos;
        F64mat quad;    };}\end{verbatim}\end{screen}\begin{itemize}
  
\item Name of the class
  \texttt{PS::SPJQuadpoleScatter}\item Members and their information  \texttt{mass}: accumulated mass or electron charge.  \texttt{pos}: center of mass or center of charge.

  \texttt{quad}: accumulated quadrupole.\item Terms of use  The same as \texttt{PS::MomentQuadrupoleScatter} class.\end{itemize}  

\subsubsubsection{PS::SEARCH\_MODE\_LONG\_SYMMETRY}\subsubsubsubsection{PS::SPJMonopoleSymmetry}
\label{sec:SPJMonopoleSymmetry}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentMonopoleSymmetry} class. It contains up to monopole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJMonopoleSymmetry {    public:        F64    mass;        F64vec pos;    };}\end{verbatim}\end{screen}\begin{itemize}
  
\item Name of the class
  \texttt{PS::SPJMonopoleSymmetry}\item Members and their information  \texttt{mass}: accumulated mass or electron charge.  \texttt{pos}: center of mass or center of charge.\item Terms of use  The same as \texttt{PS::MomentMonopoleSymmetry} class.\end{itemize}  

\subsubsubsubsection{PS::SPJQuadrupoleSymmetry}
\label{sec:SPJQuadrupoleSymmetry}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentQuadrupoleSymmetry} class. It contains up to quadrupole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJQuadrupoleSymmetry {    public:        F64    mass;        F64vec pos;
        F64mat quad;    };}\end{verbatim}\end{screen}\begin{itemize}
  
\item Name of the class
  \texttt{PS::SPJQuadpoleSymmetry}\item Members and their information  \texttt{mass}: accumulated mass or electron charge.  \texttt{pos}: center of mass or center of charge.

  \texttt{quad}: accumulated quadrupole.\item Terms of use  The same as \texttt{PS::MomentQuadrupoleSymmetry} class.\end{itemize}  
\subsubsubsection{PS::SEARCH\_MODE\_LONG\_CUTOFF}\subsubsubsubsection{PS::SPJMonopoleCutoff}
\label{sec:SPJMonopoleCutoff}A \texttt{SuperParticleJ} class which is related to \texttt{PS::MomentMonopoleCutoff} class. It contains up to monopole moment.\begin{screen}\begin{verbatim}namespace ParticleSimulator {    class SPJMonopoleCutoff {    public:        F64    mass;        F64vec pos;    };}\end{verbatim}\end{screen}\begin{itemize}\item Name of the class
  \texttt{PS::SPJMonopoleCutoff}\item Members and their information  \texttt{mass}: accumulated mass or electron charge.  \texttt{pos}: center of mass or center of charge.\item Terms of use  The same as \texttt{PS::MomentMonopoleCutoff} class.\end{itemize}\subsubsection{Required member functions}\subsubsubsection{Summary}Below, the required member functions of \texttt{SuperParticleJ} class are described. In this section we use the name \texttt{SPJ} as a \texttt{SuperParticleJ} class.\subsubsubsection{SPJ::getPos}\begin{screen}\begin{verbatim}class SPJ {public:    PS::F64vec getPos() const;};\end{verbatim}\end{screen}\begin{itemize}\item {\bf Arguments}  None.  \item {\bf Returns}  \texttt{PS::F32vec} or \texttt{PS::F64vec}.  Returns the position pf a super-particle of class \texttt{SPJ}.  \end{itemize}\subsubsubsection{SPJ::setPos}\begin{screen}\begin{verbatim}class SPJ {public:    void setPos(const PS::F64vec pos_new);};\end{verbatim}\end{screen}\begin{itemize}\item {\bf Arguments}  \texttt{pos\_new}: Input. \texttt{const PS::F32vec} or \texttt{const PS::F64vec}.  Modified positions of particle by FDPS.\item {\bf Returns}  None.  \item {\bf Behaviour}  Replaces the positions in \texttt{SPJ} class by those modified by FDPS.\end{itemize}\subsubsubsection{SPJ::copyFromMoment}\begin{screen}\begin{verbatim}class Mom;class SPJ {public:    void copyFromMoment(const Mom & mom);};\end{verbatim}\end{screen}\begin{itemize}  \item {\bf Arguments}  \texttt{mom}: Input. \texttt{const Mom \&} type.  \texttt{Mom} can be both user defined and pre-defined \texttt{Moment} class.\item {\bf Returns}  None.  \item {\bf Behaviour}  Copies the informations of \texttt{Mom} class to \texttt{SPJ}.\end{itemize}\subsubsubsection{SPJ::convertToMoment}\begin{screen}\begin{verbatim}class Mom {public:    Mom(const PS::F32 m,        const PS::F32vec & p);}class SPJ {public:    Mom convertToMoment() const;};\end{verbatim}\end{screen}\begin{itemize}  \item {\bf Arguments}  None.\item {\bf Returns}  \texttt{Mom} type.  The constructor of \texttt{Mom} class.\item {\bf Behaviour}  Returns the constructor of \texttt{Mom} class.\end{itemize}\subsubsubsection{SPJ::clear}\begin{screen}\begin{verbatim}class SPJ {public:    void clear();};\end{verbatim}\end{screen}\begin{itemize}  \item {\bf Arguments}  None.\item {\bf Returns}  None.  \item {\bf Behaviour}  Clears the information of \texttt{SPJ} class.\end{itemize}\subsubsection{Required member functions for specific case}\subsubsubsection{Serialize particle data when LET exchange}\label{sec:SPJ:serialize}Member functions \texttt{SPJ::pack} and \texttt{SPJ::unpack} are necessary, if serializing particle data when LET exchange. Below, we describe the specifications for these functions.%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\subsubsubsubsection{SPJ::pack}\begin{screen}\begin{verbatim}class SPJ {public:    static PS::S32 pack(const PS::S32 n_ptcl, const SPJ *ptcl[], char *buf,                         size_t & packed_size, const size_t max_buf_size);};\end{verbatim}\end{screen}\begin{itemize}\item {\bf Arguments}  \texttt{n\_ptcl}: Number of superparticles to be sent when LET exchange.
  \texttt{ptcl}: Array of pointers to superparticles to be sent. 
  \texttt{buf}: Beginning address of a send buffer. 

  \texttt{packed\_size}: Size to be written to the send buffer by the user (in bytes). 
    \texttt{max\_buf\_size}: Size of writable area of the send buffer (in bytes).\item {\bf Returns}  Type \texttt{PS::S32}. Returns -1 if \texttt{packed\_size} is greater than \texttt{max\_buf\_size}. Otherwise, returns 0.  \item {\bf Behaviour} This function serializes the data of particles to be sent when LET exchange and writes them to a send buffer.\end{itemize}%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\subsubsubsubsection{SPJ::unPack}\begin{screen}\begin{verbatim}class SPJ {public:    static void unPack(const PS::S32 n_ptcl, SPJ[],
                       const char *buf);};\end{verbatim}\end{screen}\begin{itemize}\item {\bf Arguments}  \texttt{n\_ptcl}: Number of superparticles received when LET exchange. 
                         \texttt{ptcl}: Array of superparticles to store the received superparticles.
                         \texttt{buf}: Beginning address of a receive buffer.\item {\bf Returns}  None.\item {\bf Behaviour} This function deserializes a received data of superparticles when LET exchange and writes them to an array of superparticles.\end{itemize}